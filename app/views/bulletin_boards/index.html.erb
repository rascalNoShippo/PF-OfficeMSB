<% content_for :title, "掲示板" %>
<div class="p-3">
	<div class="d-flex justify-content-between">
		<div>
			<h3>
				<i class="fas fa-clipboard"></i>
				<%= @q ? "検索結果" : "掲示板" %>
			</h3>
		</div>
		<div class="d-flex">
			<%# 検索BOX %>
			<%= form_with method: :get, class: "d-flex my-auto" do |f| %>
				<div class="input-group">
					<%= f.text_field :query, value: @q, class: "form-control input-group-prepend" %>
					<span class="input-group-btn input-group-append">
						<%= f.button type: "submit", name: nil, class: "btn btn-dark" do %>
							<i class="fas fa-search"></i>
						<% end %>
					</span>
				</div>
			<% end %>
		</div>
	</div>
	<p>
		<%= link_to "掲示を書き込む", new_bulletin_board_path unless @q %>
	</p>
	<div class="d-flex">
		<div class="message_list col-12">
			<table class="table table-striped">
				<caption>
					<p class="text-right">
						全
						<%= @total_count %>
						件中
						<%= "#{@count_start} - #{@count_end}" %>
						件目 (<%= "#{@current_page} / #{@num_pages}" %>
						ページ)
					</p>
				</caption>
				<thead>
					<tr>
						<th></th>
						<th>標題</th>
						<th>差出人</th>
						<th>更新日時</th>
					</tr>
				</thead>
				<tbody>
					<% @articles.each do |item| #掲示一覧 %>
						<tr<%= " class=unread" unless item.view_flag %>>
							<td class="favorite_<%= item.id %> star pr-0 text-center">
								<%= render "favorites/star", item: item %>
							</td>
							<td class="overflow_ellipsis<%= " font-weight-bold" unless item.view_flag %>">
								<p class="overflow_ellipsis"><%= link_to item.title, bulletin_board_path(item.id) %></p>
							</td>
							<td class="overflow_ellipsis">
								<p class="overflow_ellipsis"><%= link_to item.sender.icon + item.sender.name, user_path(item.sender.id) %></p>
							</td>
							<td><%= date_or_time(item.updated_at) %></td>
						</tr>
					<% end %>
				</tbody>
			</table>
			<%= paginate @articles %>
		</div>
	</div>
</div>

